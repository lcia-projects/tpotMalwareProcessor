# tpotMalwareProcessor

This is a set of utilities that allow you to archive malware longer than 30 days
and then transfer those malware samples to a central server for processing. 

Processing currently involves querying Virus Total. If the malware has been 
seen before it pulls data from virus total. If is not in the virus total
database, it then submits the sample and waits 5 minutes for virus total to
process the sample. Then queries Virus total for the results of the processing. 

Virus Total Community API Key rate limits to 4 samples per minute up to
500 samples a day. Thats ALOT of malware from a honeypot. You shouldnt hit
these limits. 

Results are then saved in a JSON formatted file locally, and/or sent to 
an ElasticSearch Server for visualization/analysis. 

There are 3 seperate scripts to operate this process:
- Archiver: run ON the honeypot with a cron job. i run it at midnight. This 
script grabs the binary data from the folders listed in the configuration 
  file, renames them to: Hostname+DockerHoneyPotName+Filename+.tgz, then puts 
  these files in a "transfer" folder.
  
- Downloader: run on central server used for malware analysis. It will reach
out to honeypots listed in configuration file, download malware from transfer
  folder. 
  
- Processor: run on central server. Unzips each daily malware archive, hashes
files, submits hashes to virus total. If in VT database, pulls data from database
  if not found in VT database, submits file, waits for results. Then saves all 
  results in json text file locally, or to ElasticSearch cluster. 
  